# Ichime

Нативное приложение для сайта Anime 365, созданное специально для iPhone, iPad и Apple TV.

## Скриншоты

Скриншоты с iPhone, iPad и Apple TV можно найти на странице [Wiki → Скриншоты](https://github.com/midori-no-me/ichime/wiki/Скриншоты).

## Возможности приложения

Приложение покрывает все базовые сценарии пользования сайтом, касающиеся именно просмотра сериалов.

Плеер:

- Системный плеер — такой же, как в Safari и приложении "TV".
- Поддержка субтитров. Поддерживаются только субтитры в формате WebVTT.
- Поддержка AirPlay. Но без внешних субтитров.
- Внутри плеера отображается название сериала и номер серии.
- Если досмотреть серию до конца, то она автоматически будет отмечена просмотренной. Так же, как это сделано на сайте.

Ваша библиотека:

- Выводим список следующих серий к просмотру так же, как на сайте они выводятся в секции "Серии к просмотру".
- Раздел уведомлений с сайта, в котором отображается список вышедших недавно серий или сериалов. Но push-уведомления отправлять пока не умеем.
- Если перейти на страницу сериала, то его можно добавить в свой список.

Каталог сериалов:

- Список онгоингов.
- Поиск.
- Просмотр базовой информации о сериале.

## Как установить

Способы установки описаны на странице [Wiki → Как установить приложение](https://github.com/midori-no-me/ichime/wiki/Как-установить-приложение).

## Архитектура

Приложение построено на SwiftUI и AVKit.

### Взаимодействие с сайтом

У сайта есть HTTP API, но там поддерживаются не все возможности — только read-only запросы.

Все запросы с сессией пользователя, а также запросы, мутирующие состояние сервера, выполняются не к API, а к самому сайту — так, будто бы это запросы из браузера. Это значит, что некоторые данные получаются путем парсинга HTML самого сайта.

### Субтитры

На сайте субтитры распространяются в формате `.vtt` ([WebVTT](https://en.wikipedia.org/wiki/WebVTT)), поэтому мы их передаем в видео-плеер как есть.

Так как WebVTT субтитры сайт генерирует автоматически на основе других субтитров (ASS или SRT), то в некоторых переводах, особенно где переводят надписи на экране, возможен не очень красивый рендеринг субтитров.
